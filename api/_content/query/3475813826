[{"_path":"/configuration/block/jwt_signing_profile","_draft":false,"_partial":false,"_empty":false,"title":"JWT Signing Profile","description":"The jwt_signing_profile block lets you configure a JSON Web Token signing\nprofile for your gateway. It is referenced in the jwt_sign() function\nby its required label.","excerpt":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"jwt-signing-profile"},"children":[{"type":"text","value":"JWT Signing Profile"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"jwt_signing_profile"}]},{"type":"text","value":" block lets you configure a JSON Web Token signing\nprofile for your gateway. It is referenced in the "},{"type":"element","tag":"a","props":{"href":"../functions"},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"jwt_sign()"}]},{"type":"text","value":" function"}]},{"type":"text","value":"\nby its required "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"label"}]},{"type":"text","value":"."}]},{"type":"element","tag":"table","props":{},"children":[{"type":"element","tag":"thead","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"Block name"}]},{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"Context"}]},{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"Label"}]},{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"Nested block(s)"}]}]}]},{"type":"element","tag":"tbody","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"jwt_signing_profile"}]}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"element","tag":"a","props":{"href":"definitions"},"children":[{"type":"text","value":"Definitions Block"}]}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"required"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"-"}]}]}]}]},{"type":"element","tag":"attributes","props":{":values":"[{\"name\":\"claims\",\"type\":\"object\",\"default\":\"\",\"description\":\"claims for the JWT payload, claim values are evaluated per request\"},{\"name\":\"headers\",\"type\":\"object\",\"default\":\"\",\"description\":\"additional header fields for the JWT, `alg` and `typ` cannot be set\"},{\"name\":\"key\",\"type\":\"string\",\"default\":\"\",\"description\":\"private key (in PEM format) for `RS*` and `ES*` variants or the secret for `HS*` algorithms\"},{\"name\":\"key_file\",\"type\":\"string\",\"default\":\"\",\"description\":\"optional file reference instead of `key` usage\"},{\"name\":\"signature_algorithm\",\"type\":\"string\",\"default\":\"\",\"description\":\"algorithm used for signing: `\\\"RS256\\\"`, `\\\"RS384\\\"`, `\\\"RS512\\\"`, `\\\"HS256\\\"`, `\\\"HS384\\\"`, `\\\"HS512\\\"`, `\\\"ES256\\\"`, `\\\"ES384\\\"`, `\\\"ES512\\\"`\"},{\"name\":\"ttl\",\"type\":\"string\",\"default\":\"\",\"description\":\"The token's time-to-live, creates the `exp` claim\"}]"},"children":[]},{"type":"element","tag":"duration","props":{},"children":[{"type":"element","tag":"hr","props":{},"children":[]}]},{"type":"element","tag":"h3","props":{"id":"example"},"children":[{"type":"text","value":"Example"}]},{"type":"element","tag":"code","props":{"code":"jwt_signing_profile \"myjwt\" {\n  signature_algorithm = \"RS256\"\n  key_file = \"priv_key.pem\"\n  ttl = \"600s\"\n  claims = {\n    iss = \"MyAS\"\n    iat = unixtime()\n  }\n  headers = {\n    kid = \"my-jwk-id\"\n  }\n}\n","language":"hcl"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"jwt_signing_profile \"myjwt\" {\n  signature_algorithm = \"RS256\"\n  key_file = \"priv_key.pem\"\n  ttl = \"600s\"\n  claims = {\n    iss = \"MyAS\"\n    iat = unixtime()\n  }\n  headers = {\n    kid = \"my-jwk-id\"\n  }\n}\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"A detailed example can be found "},{"type":"element","tag":"a","props":{"href":"https://github.com/avenga/couper-examples/blob/master/creating-jwt/README.md","rel":["nofollow","noopener","noreferrer"],"target":"_blank"},"children":[{"type":"text","value":"here"}]},{"type":"text","value":"."}]}]},"_type":"markdown","_id":"content:2.configuration:4.block:jwt_signing_profile.md","_source":"content","_file":"2.configuration/4.block/jwt_signing_profile.md","_extension":"md"},{"_path":"/configuration/block/oauth2","_draft":false,"_partial":false,"_empty":false,"title":"OAuth2 AC (Beta)","description":"The beta_oauth2 block lets you configure the oauth2_authorization_url() function and an access\ncontrol for an OAuth2 Authorization Code Grant Flow redirect endpoint.\nLike all access control types, the beta_oauth2 block is defined in the definitions block and can be referenced in all configuration blocks by its required label.","excerpt":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"oauth2-ac-beta"},"children":[{"type":"text","value":"OAuth2 AC (Beta)"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"beta_oauth2"}]},{"type":"text","value":" block lets you configure the "},{"type":"element","tag":"a","props":{"href":"../functions"},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"oauth2_authorization_url()"}]},{"type":"text","value":" function"}]},{"type":"text","value":" and an access\ncontrol for an OAuth2 "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Authorization Code Grant Flow"}]},{"type":"text","value":" redirect endpoint.\nLike all "},{"type":"element","tag":"a","props":{"href":"../access-control"},"children":[{"type":"text","value":"access control"}]},{"type":"text","value":" types, the "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"beta_oauth2"}]},{"type":"text","value":" block is defined in the "},{"type":"element","tag":"a","props":{"href":"definitions"},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"definitions"}]},{"type":"text","value":" block"}]},{"type":"text","value":" and can be referenced in all configuration blocks by its required "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"label"}]},{"type":"text","value":"."}]},{"type":"element","tag":"table","props":{},"children":[{"type":"element","tag":"thead","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"Block name"}]},{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"Context"}]},{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"Label"}]},{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"Nested block(s)"}]}]}]},{"type":"element","tag":"tbody","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"beta_oauth2"}]}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"element","tag":"a","props":{"href":"definitions"},"children":[{"type":"text","value":"Definitions Block"}]}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"⚠ required"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"element","tag":"a","props":{"href":"backend"},"children":[{"type":"text","value":"Backend Block"}]},{"type":"text","value":", "},{"type":"element","tag":"a","props":{"href":"error_handler"},"children":[{"type":"text","value":"Error Handler Block"}]}]}]}]}]},{"type":"element","tag":"table","props":{},"children":[{"type":"element","tag":"thead","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"Attribute(s)"}]},{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"Type"}]},{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"Default"}]},{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"Description"}]},{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"Characteristic(s)"}]},{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"Example"}]}]}]},{"type":"element","tag":"tbody","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"backend"}]}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"string"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"element","tag":"a","props":{"href":"backend"},"children":[{"type":"text","value":"Backend Block Reference"}]}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"⚠ Do not disable the peer certificate validation with "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"disable_certificate_validation = true"}]},{"type":"text","value":"!"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"-"}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"authorization_endpoint"}]}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"string"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"The authorization server endpoint URL used for authorization."}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"⚠ required"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"-"}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"token_endpoint"}]}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"string"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"The authorization server endpoint URL used for requesting the token."}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"⚠ required"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"-"}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"token_endpoint_auth_method"}]}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"string"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"\"client_secret_basic\""}]}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"Defines the method to authenticate the client at the token endpoint."}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"If set to "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"client_secret_post\""}]},{"type":"text","value":", the client credentials are transported in the request body. If set to "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"\"client_secret_basic\""}]},{"type":"text","value":", the client credentials are transported via Basic Authentication."}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"-"}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"redirect_uri"}]}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"string"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"The Couper endpoint for receiving the authorization code."}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"⚠ required. Relative URL references are resolved against the origin of the current request URL. The origin can be changed with the "},{"type":"element","tag":"a","props":{"href":"settings"},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"accept_forwarded_url"}]}]},{"type":"text","value":" attribute if Couper is running behind a proxy."}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"-"}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"grant_type"}]}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"string"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"The grant type."}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"⚠ required, to be set to: "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"\"authorization_code\""}]}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"grant_type = \"authorization_code\""}]}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"client_id"}]}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"string"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"The client identifier."}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"⚠ required"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"-"}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"client_secret"}]}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"string"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"The client password."}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"⚠ required."}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"-"}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"scope"}]}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"string"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"A space separated list of requested scope values for the access token."}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"scope = \"read write\""}]}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"verifier_method"}]}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"string"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"The method to verify the integrity of the authorization code flow"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"⚠ required, available values: "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"\"ccm_s256\""}]},{"type":"text","value":" ("},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"code_challenge"}]},{"type":"text","value":" parameter with "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"code_challenge_method"}]},{"type":"text","value":" "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"S256"}]},{"type":"text","value":"), "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"\"state\""}]},{"type":"text","value":" ("},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"state"}]},{"type":"text","value":" parameter)"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"verifier_method = \"ccm_s256\""}]}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"verifier_value"}]}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"string or expression"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"The value of the (unhashed) verifier."}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"⚠ required; e.g. using cookie value created with "},{"type":"element","tag":"a","props":{"href":"../functions"},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"oauth2_verifier()"}]},{"type":"text","value":" function"}]}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"verifier_value = request.cookies.verifier"}]}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"custom_log_fields"}]}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"object"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"Defines log fields for "},{"type":"element","tag":"a","props":{"href":"/observation/logging#custom-logging"},"children":[{"type":"text","value":"Custom Logging"}]},{"type":"text","value":"."}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"⚠ Inherited by nested blocks."}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"-"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"If the authorization server supports the "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"code_challenge_method"}]},{"type":"text","value":" "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"S256"}]},{"type":"text","value":" (a.k.a. PKCE, see RFC 7636), we recommend "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"verifier_method = \"ccm_s256\""}]},{"type":"text","value":"."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The HTTP header field "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"Accept: application/json"}]},{"type":"text","value":" is automatically added to the token request. This can be modified with "},{"type":"element","tag":"a","props":{"href":"../modifiers#request-header"},"children":[{"type":"text","value":"request header modifiers"}]},{"type":"text","value":" in a "},{"type":"element","tag":"a","props":{"href":"backend"},"children":[{"type":"text","value":"backend block"}]},{"type":"text","value":"."}]}]},"_type":"markdown","_id":"content:2.configuration:4.block:oauth2.md","_source":"content","_file":"2.configuration/4.block/oauth2.md","_extension":"md"}]