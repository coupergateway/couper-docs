[null,{"_path":"/getting-started/examples","_draft":false,"_partial":false,"_locale":"en","_empty":false,"title":"Examples","description":"","excerpt":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"examples"},"children":[{"type":"text","value":"Examples"}]},{"type":"element","tag":"h2","props":{"id":"file-and-web-serving"},"children":[{"type":"text","value":"File and Web Serving"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Couper contains a Web server for simple file serving and also takes care of the more complex web serving of SPA assets."}]},{"type":"element","tag":"code","props":{"code":"server \"example\" {\n\n  files {\n    document_root = \"htdocs\"\n  }\n\n  spa {\n    bootstrap_file = \"htdocs/index.html\"\n    paths = [\"/**\"]\n  }\n}\n","language":"hcl"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"server \"example\" {\n\n  files {\n    document_root = \"htdocs\"\n  }\n\n  spa {\n    bootstrap_file = \"htdocs/index.html\"\n    paths = [\"/**\"]\n  }\n}\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"files"}]},{"type":"text","value":" block configures Couper's file server. It needs to know which directory to serve ("},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"document_root"}]},{"type":"text","value":")."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"spa"}]},{"type":"text","value":" block is responsible for serving the bootstrap document for all paths that match the paths list."}]},{"type":"element","tag":"h2","props":{"id":"exposing-apis"},"children":[{"type":"text","value":"Exposing APIs"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Couper's main concept is exposing APIs via the configuration block "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"endpoint"}]},{"type":"text","value":", fetching data from upstream or remote services, represented by the configuration block "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"backend"}]},{"type":"text","value":"."}]},{"type":"element","tag":"code","props":{"code":"server \"example\"{\n\n  endpoint \"/public/**\"{\n\n    proxy {\n      backend {\n        origin = \"https://httpbin.org\"\n        path = \"/**\"\n      }\n    }\n  }\n}\n","language":"hcl"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"server \"example\"{\n\n  endpoint \"/public/**\"{\n\n    proxy {\n      backend {\n        origin = \"https://httpbin.org\"\n        path = \"/**\"\n      }\n    }\n  }\n}\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This basic configuration defines an upstream backend service ("},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"https://httpbin.org"}]},{"type":"text","value":") and \"mounts\" it on the local API endpoint "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"/public/**"}]},{"type":"text","value":"."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"An incoming request "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"/public/foo"}]},{"type":"text","value":" will result in an outgoing request "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"https://httpbin.org/foo"}]},{"type":"text","value":"."}]},{"type":"element","tag":"h2","props":{"id":"securing-apis"},"children":[{"type":"text","value":"Securing APIs"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Access control is controlled by an\n"},{"type":"element","tag":"a","props":{"href":"/configuration/access-control"},"children":[{"type":"text","value":"access control"}]},{"type":"text","value":" attribute that can be set for many blocks."}]},{"type":"element","tag":"code","props":{"code":"server \"example\" {\n\n  endpoint \"/private/**\" {\n    access_control = [\"accessToken\"]\n\n    proxy {\n      backend {\n        origin = \"https://httpbin.org\"\n        path = \"/**\"\n      }\n    }\n  }\n\n  definitions {\n    jwt \"accessToken\" {\n      signature_algorithm = \"RS256\"\n      key_file = \"keys/public.pem\"\n      header = \"Authorization\"\n    }\n  }\n}\n","language":"hcl"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"server \"example\" {\n\n  endpoint \"/private/**\" {\n    access_control = [\"accessToken\"]\n\n    proxy {\n      backend {\n        origin = \"https://httpbin.org\"\n        path = \"/**\"\n      }\n    }\n  }\n\n  definitions {\n    jwt \"accessToken\" {\n      signature_algorithm = \"RS256\"\n      key_file = \"keys/public.pem\"\n      header = \"Authorization\"\n    }\n  }\n}\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This configuration protects the endpoint "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"/private/**"}]},{"type":"text","value":" with the access control "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"\"accessToken\""}]},{"type":"text","value":" configured in the "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"definitions"}]},{"type":"text","value":" block."}]},{"type":"element","tag":"h2","props":{"id":"routing-path-mapping"},"children":[{"type":"text","value":"Routing: Path Mapping"}]},{"type":"element","tag":"code","props":{"code":"api \"my_api\" {\n  base_path = \"/api/v1\"\n\n  endpoint \"/login/**\" {\n    proxy {\n      backend {\n        origin = \"http://identityprovider:8080\"\n      }\n    }\n  }\n\n  endpoint \"/cart/**\" {\n    proxy {\n      url = \"http://cartservice:8080/api/v1/**\"\n    }\n  }\n\n  endpoint \"/account/{id}\" {\n    proxy {\n      backend {\n        path = \"/user/${request.param.id}/info\"\n        origin = \"http://accountservice:8080\"\n      }\n    }\n  }\n}\n","language":"hcl"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"api \"my_api\" {\n  base_path = \"/api/v1\"\n\n  endpoint \"/login/**\" {\n    proxy {\n      backend {\n        origin = \"http://identityprovider:8080\"\n      }\n    }\n  }\n\n  endpoint \"/cart/**\" {\n    proxy {\n      url = \"http://cartservice:8080/api/v1/**\"\n    }\n  }\n\n  endpoint \"/account/{id}\" {\n    proxy {\n      backend {\n        path = \"/user/${request.param.id}/info\"\n        origin = \"http://accountservice:8080\"\n      }\n    }\n  }\n}\n"}]}]}]},{"type":"element","tag":"table","props":{},"children":[{"type":"element","tag":"thead","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"Incoming request"}]},{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"Outgoing request"}]}]}]},{"type":"element","tag":"tbody","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"/api/v1/login/foo"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"http://identityprovider:8080/login/foo"}]}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"/api/v1/cart/items"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"http://cartservice:8080/api/v1/items"}]}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"/api/v1/account/brenda"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"http://accountservice:8080/user/brenda/info"}]}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"using-variables-and-expressions"},"children":[{"type":"text","value":"Using Variables and Expressions"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"An example to send an additional header with client request header to a configured\nbackend and gets evaluated on per-request basis:"}]},{"type":"element","tag":"code","props":{"code":"server {\n  endpoint \"/\" {\n    proxy {\n      backend {\n        origin = \"https://httpbin.org/\"\n        path = \"/anything\"\n        set_request_headers = {\n          # simple variable lookup\n          x-uuid = request.id\n          # template string\n          user-agent = \"myproxyClient/${request.headers.app-version}\"\n          # expressions and function calls\n          x-env-user = env.USER != \"\" ? to_upper(env.USER) : \"UNKNOWN\"\n        }\n      }\n    }\n  }\n}\n","language":"hcl"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"server {\n  endpoint \"/\" {\n    proxy {\n      backend {\n        origin = \"https://httpbin.org/\"\n        path = \"/anything\"\n        set_request_headers = {\n          # simple variable lookup\n          x-uuid = request.id\n          # template string\n          user-agent = \"myproxyClient/${request.headers.app-version}\"\n          # expressions and function calls\n          x-env-user = env.USER != \"\" ? to_upper(env.USER) : \"UNKNOWN\"\n        }\n      }\n    }\n  }\n}\n"}]}]}]}]},"_type":"markdown","_id":"content:1.getting-started:3.examples.md","_source":"content","_file":"1.getting-started/3.examples.md","_extension":"md"}]