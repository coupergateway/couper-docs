{"_path":"/configuration/block/oidc","_draft":false,"_partial":false,"_locale":"en","_empty":false,"title":"OIDC","description":"The oidc block lets you configure the oauth2_authorization_url() function and an access\ncontrol for an OIDC Authorization Code Grant Flow redirect endpoint.\nLike all access control types, the oidc block is defined in the definitions Block and can be referenced in all configuration blocks by its required label.","excerpt":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"oidc"},"children":[{"type":"text","value":"OIDC"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"oidc"}]},{"type":"text","value":" block lets you configure the "},{"type":"element","tag":"a","props":{"href":"/configuration/functions"},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"oauth2_authorization_url()"}]},{"type":"text","value":" function"}]},{"type":"text","value":" and an access\ncontrol for an OIDC "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Authorization Code Grant Flow"}]},{"type":"text","value":" redirect endpoint.\nLike all "},{"type":"element","tag":"a","props":{"href":"/configuration/access-control"},"children":[{"type":"text","value":"access control"}]},{"type":"text","value":" types, the "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"oidc"}]},{"type":"text","value":" block is defined in the "},{"type":"element","tag":"a","props":{"href":"/configuration/block/definitions"},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"definitions"}]},{"type":"text","value":" Block"}]},{"type":"text","value":" and can be referenced in all configuration blocks by its required "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"label"}]},{"type":"text","value":"."}]},{"type":"element","tag":"table","props":{},"children":[{"type":"element","tag":"thead","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"Block name"}]},{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"Context"}]},{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"Label"}]},{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"Nested block(s)"}]}]}]},{"type":"element","tag":"tbody","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"oidc"}]}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"element","tag":"a","props":{"href":"/configuration/block/definitions"},"children":[{"type":"text","value":"Definitions Block"}]}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"⚠ required"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"element","tag":"a","props":{"href":"/configuration/block/backend"},"children":[{"type":"text","value":"Backend Block"}]},{"type":"text","value":", "},{"type":"element","tag":"a","props":{"href":"/configuration/block/error_handler"},"children":[{"type":"text","value":"Error Handler Block"}]}]}]}]}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"any "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"backend"}]},{"type":"text","value":" attributes: Do not disable the peer certificate validation with "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"disable_certificate_validation = true"}]},{"type":"text","value":"."}]}]},{"type":"element","tag":"attributes","props":{":values":"[{\"default\":\"\",\"description\":\"`backend` block reference, defined in [`definitions`](/configuration/block/definitions). Required, if no [`backend` block](/configuration/block/backend) or `configuration_url` is defined within.\",\"name\":\"backend\",\"type\":\"string\"},{\"default\":\"\",\"description\":\"The client identifier.\",\"name\":\"client_id\",\"type\":\"string\"},{\"default\":\"\",\"description\":\"The client password.\",\"name\":\"client_secret\",\"type\":\"string\"},{\"default\":\"\",\"description\":\"Optional option to configure specific behavior for a given OIDC backend.\",\"name\":\"configuration_backend\",\"type\":\"object\"},{\"default\":\"\\\"1h\\\"\",\"description\":\"Duration a cached OpenID configuration stays valid after its TTL has passed.\",\"name\":\"configuration_max_stale\",\"type\":\"duration\"},{\"default\":\"\\\"1h\\\"\",\"description\":\"The duration to cache the OpenID configuration located at `configuration_url`.\",\"name\":\"configuration_ttl\",\"type\":\"duration\"},{\"default\":\"\",\"description\":\"The OpenID configuration URL.\",\"name\":\"configuration_url\",\"type\":\"string\"},{\"default\":\"\",\"description\":\"log fields for [custom logging](/observation/logging#custom-logging). Inherited by nested blocks.\",\"name\":\"custom_log_fields\",\"type\":\"object\"},{\"default\":\"\\\"1h\\\"\",\"description\":\"Time period the cached JWK set stays valid after its TTL has passed.\",\"name\":\"jwks_max_stale\",\"type\":\"duration\"},{\"default\":\"\\\"1h\\\"\",\"description\":\"Time period the JWK set stays valid and may be cached.\",\"name\":\"jwks_ttl\",\"type\":\"duration\"},{\"default\":\"\",\"description\":\"Optional option to configure specific behavior for a given OIDC backend.\",\"name\":\"jwks_uri_backend\",\"type\":\"object\"},{\"default\":\"\",\"description\":\"The Couper endpoint for receiving the authorization code. Relative URL references are resolved against the origin of the current request URL. The origin can be changed with the `accept_forwarded_url`(`settings` block) attribute if Couper is running behind a proxy.\",\"name\":\"redirect_uri\",\"type\":\"string\"},{\"default\":\"\",\"description\":\"A space separated list of requested scope values for the access token.\",\"name\":\"scope\",\"type\":\"string\"},{\"default\":\"\",\"description\":\"Optional option to configure specific behavior for a given OIDC backend.\",\"name\":\"token_backend\",\"type\":\"object\"},{\"default\":\"\\\"client_secret_basic\\\"\",\"description\":\"Defines the method to authenticate the client at the token endpoint. If set to `client_secret_post`, the client credentials are transported in the request body. If set to `client_secret_basic`, the client credentials are transported via Basic Authentication.\",\"name\":\"token_endpoint_auth_method\",\"type\":\"string\"},{\"default\":\"\",\"description\":\"Optional option to configure specific behavior for a given OIDC backend.\",\"name\":\"userinfo_backend\",\"type\":\"object\"},{\"default\":\"\",\"description\":\"The method to verify the integrity of the authorization code flow.\",\"name\":\"verifier_method\",\"type\":\"string\"},{\"default\":\"\",\"description\":\"The value of the (unhashed) verifier.\",\"name\":\"verifier_value\",\"type\":\"string\"}]"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In most cases, referencing one "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"backend"}]},{"type":"text","value":" (backend attribute) for all the backend requests sent by the OIDC client is enough.\nYou should only use "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"configuration_backend"}]},{"type":"text","value":", "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"jwks_uri_backend"}]},{"type":"text","value":", "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"token_backend"}]},{"type":"text","value":" or "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"userinfo_backend"}]},{"type":"text","value":" if you need to configure a specific behaviour for the respective request (e.g. timeouts)."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"If the OpenID server supports the "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"code_challenge_method"}]},{"type":"text","value":" "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"S256"}]},{"type":"text","value":" the default value for "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"verifier_method"}]},{"type":"text","value":"is "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"\"ccm_s256\""}]},{"type":"text","value":", "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"\"nonce\""}]},{"type":"text","value":" otherwise."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The HTTP header field "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"Accept: application/json"}]},{"type":"text","value":" is automatically added to the token request. This can be modified with "},{"type":"element","tag":"a","props":{"href":"/configuration/modifiers#request-header"},"children":[{"type":"text","value":"request header modifiers"}]},{"type":"text","value":" in a "},{"type":"element","tag":"a","props":{"href":"/configuration/block/backend"},"children":[{"type":"text","value":"backend block"}]},{"type":"text","value":"."}]},{"type":"element","tag":"duration","props":{},"children":[]}]},"body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"oidc"},"children":[{"type":"text","value":"OIDC"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"oidc"}]},{"type":"text","value":" block lets you configure the "},{"type":"element","tag":"a","props":{"href":"/configuration/functions"},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"oauth2_authorization_url()"}]},{"type":"text","value":" function"}]},{"type":"text","value":" and an access\ncontrol for an OIDC "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Authorization Code Grant Flow"}]},{"type":"text","value":" redirect endpoint.\nLike all "},{"type":"element","tag":"a","props":{"href":"/configuration/access-control"},"children":[{"type":"text","value":"access control"}]},{"type":"text","value":" types, the "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"oidc"}]},{"type":"text","value":" block is defined in the "},{"type":"element","tag":"a","props":{"href":"/configuration/block/definitions"},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"definitions"}]},{"type":"text","value":" Block"}]},{"type":"text","value":" and can be referenced in all configuration blocks by its required "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"label"}]},{"type":"text","value":"."}]},{"type":"element","tag":"table","props":{},"children":[{"type":"element","tag":"thead","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"Block name"}]},{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"Context"}]},{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"Label"}]},{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"Nested block(s)"}]}]}]},{"type":"element","tag":"tbody","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"oidc"}]}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"element","tag":"a","props":{"href":"/configuration/block/definitions"},"children":[{"type":"text","value":"Definitions Block"}]}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"⚠ required"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"element","tag":"a","props":{"href":"/configuration/block/backend"},"children":[{"type":"text","value":"Backend Block"}]},{"type":"text","value":", "},{"type":"element","tag":"a","props":{"href":"/configuration/block/error_handler"},"children":[{"type":"text","value":"Error Handler Block"}]}]}]}]}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"any "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"backend"}]},{"type":"text","value":" attributes: Do not disable the peer certificate validation with "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"disable_certificate_validation = true"}]},{"type":"text","value":"."}]}]},{"type":"element","tag":"attributes","props":{":values":"[{\"default\":\"\",\"description\":\"`backend` block reference, defined in [`definitions`](/configuration/block/definitions). Required, if no [`backend` block](/configuration/block/backend) or `configuration_url` is defined within.\",\"name\":\"backend\",\"type\":\"string\"},{\"default\":\"\",\"description\":\"The client identifier.\",\"name\":\"client_id\",\"type\":\"string\"},{\"default\":\"\",\"description\":\"The client password.\",\"name\":\"client_secret\",\"type\":\"string\"},{\"default\":\"\",\"description\":\"Optional option to configure specific behavior for a given OIDC backend.\",\"name\":\"configuration_backend\",\"type\":\"object\"},{\"default\":\"\\\"1h\\\"\",\"description\":\"Duration a cached OpenID configuration stays valid after its TTL has passed.\",\"name\":\"configuration_max_stale\",\"type\":\"duration\"},{\"default\":\"\\\"1h\\\"\",\"description\":\"The duration to cache the OpenID configuration located at `configuration_url`.\",\"name\":\"configuration_ttl\",\"type\":\"duration\"},{\"default\":\"\",\"description\":\"The OpenID configuration URL.\",\"name\":\"configuration_url\",\"type\":\"string\"},{\"default\":\"\",\"description\":\"log fields for [custom logging](/observation/logging#custom-logging). Inherited by nested blocks.\",\"name\":\"custom_log_fields\",\"type\":\"object\"},{\"default\":\"\\\"1h\\\"\",\"description\":\"Time period the cached JWK set stays valid after its TTL has passed.\",\"name\":\"jwks_max_stale\",\"type\":\"duration\"},{\"default\":\"\\\"1h\\\"\",\"description\":\"Time period the JWK set stays valid and may be cached.\",\"name\":\"jwks_ttl\",\"type\":\"duration\"},{\"default\":\"\",\"description\":\"Optional option to configure specific behavior for a given OIDC backend.\",\"name\":\"jwks_uri_backend\",\"type\":\"object\"},{\"default\":\"\",\"description\":\"The Couper endpoint for receiving the authorization code. Relative URL references are resolved against the origin of the current request URL. The origin can be changed with the `accept_forwarded_url`(`settings` block) attribute if Couper is running behind a proxy.\",\"name\":\"redirect_uri\",\"type\":\"string\"},{\"default\":\"\",\"description\":\"A space separated list of requested scope values for the access token.\",\"name\":\"scope\",\"type\":\"string\"},{\"default\":\"\",\"description\":\"Optional option to configure specific behavior for a given OIDC backend.\",\"name\":\"token_backend\",\"type\":\"object\"},{\"default\":\"\\\"client_secret_basic\\\"\",\"description\":\"Defines the method to authenticate the client at the token endpoint. If set to `client_secret_post`, the client credentials are transported in the request body. If set to `client_secret_basic`, the client credentials are transported via Basic Authentication.\",\"name\":\"token_endpoint_auth_method\",\"type\":\"string\"},{\"default\":\"\",\"description\":\"Optional option to configure specific behavior for a given OIDC backend.\",\"name\":\"userinfo_backend\",\"type\":\"object\"},{\"default\":\"\",\"description\":\"The method to verify the integrity of the authorization code flow.\",\"name\":\"verifier_method\",\"type\":\"string\"},{\"default\":\"\",\"description\":\"The value of the (unhashed) verifier.\",\"name\":\"verifier_value\",\"type\":\"string\"}]"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In most cases, referencing one "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"backend"}]},{"type":"text","value":" (backend attribute) for all the backend requests sent by the OIDC client is enough.\nYou should only use "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"configuration_backend"}]},{"type":"text","value":", "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"jwks_uri_backend"}]},{"type":"text","value":", "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"token_backend"}]},{"type":"text","value":" or "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"userinfo_backend"}]},{"type":"text","value":" if you need to configure a specific behaviour for the respective request (e.g. timeouts)."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"If the OpenID server supports the "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"code_challenge_method"}]},{"type":"text","value":" "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"S256"}]},{"type":"text","value":" the default value for "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"verifier_method"}]},{"type":"text","value":"is "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"\"ccm_s256\""}]},{"type":"text","value":", "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"\"nonce\""}]},{"type":"text","value":" otherwise."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The HTTP header field "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"Accept: application/json"}]},{"type":"text","value":" is automatically added to the token request. This can be modified with "},{"type":"element","tag":"a","props":{"href":"/configuration/modifiers#request-header"},"children":[{"type":"text","value":"request header modifiers"}]},{"type":"text","value":" in a "},{"type":"element","tag":"a","props":{"href":"/configuration/block/backend"},"children":[{"type":"text","value":"backend block"}]},{"type":"text","value":"."}]},{"type":"element","tag":"duration","props":{},"children":[]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[]}},"_type":"markdown","_id":"content:2.configuration:4.block:oidc.md","_source":"content","_file":"2.configuration/4.block/oidc.md","_extension":"md"}