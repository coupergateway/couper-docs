{"_path":"/configuration/block/environment","_draft":false,"_partial":false,"_empty":false,"title":"Environment Block","description":"The environment block lets you refine the Couper configuration based on the set\nenvironment.","excerpt":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"environment-block"},"children":[{"type":"text","value":"Environment Block"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"environment"}]},{"type":"text","value":" block lets you refine the Couper configuration based on the set\n"},{"type":"element","tag":"a","props":{"href":"/configuration/command-linemd#global-options"},"children":[{"type":"text","value":"environment"}]},{"type":"text","value":"."}]},{"type":"element","tag":"table","props":{},"children":[{"type":"element","tag":"thead","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"Block name"}]},{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"Context"}]},{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"Label"}]},{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"Nested block(s)"}]}]}]},{"type":"element","tag":"tbody","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"environment"}]}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"Overall."}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"⚠ required, multiple labels are supported."}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"All configuration blocks of Couper."}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"environment"}]},{"type":"text","value":" block works like a preprocessor. If the label of an "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"environment"}]},{"type":"text","value":"\nblock do not match the set "},{"type":"element","tag":"a","props":{"href":"./CLI.md#global-options"},"children":[{"type":"text","value":"environment"}]},{"type":"text","value":" value, the preprocessor\nremoves this block and their content. Otherwise, the content of the block is applied\nto the configuration."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"If the "},{"type":"element","tag":"a","props":{"href":"/configuration/command-linemd#global-options"},"children":[{"type":"text","value":"environment"}]},{"type":"text","value":" value set to "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"prod"}]},{"type":"text","value":", the following configuration"}]},{"type":"element","tag":"code","props":{"code":"server {\n    api \"protected\" {\n        endpoint \"/secure\" {\n            environment \"prod\" {\n                access_control = [\"jwt\"]\n            }\n\n            proxy {\n                environment \"prod\" {\n                    url = \"https://protected-resource.org\"\n                }\n                environment \"stage\" {\n                    url = \"https://test-resource.org\"\n                }\n            }\n        }\n    }\n}\n","language":"hcl"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"server {\n    api \"protected\" {\n        endpoint \"/secure\" {\n            environment \"prod\" {\n                access_control = [\"jwt\"]\n            }\n\n            proxy {\n                environment \"prod\" {\n                    url = \"https://protected-resource.org\"\n                }\n                environment \"stage\" {\n                    url = \"https://test-resource.org\"\n                }\n            }\n        }\n    }\n}\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"produces after the preprocessing the following configuration:"}]},{"type":"element","tag":"code","props":{"code":"server {\n    api \"protected\" {\n        endpoint \"/secure\" {\n            access_control = [\"jwt\"]\n\n            proxy {\n                url = \"https://protected-resource.org\"\n            }\n        }\n    }\n}\n","language":"hcl"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"server {\n    api \"protected\" {\n        endpoint \"/secure\" {\n            access_control = [\"jwt\"]\n\n            proxy {\n                url = \"https://protected-resource.org\"\n            }\n        }\n    }\n}\n"}]}]}]}]},"body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"environment-block"},"children":[{"type":"text","value":"Environment Block"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"environment"}]},{"type":"text","value":" block lets you refine the Couper configuration based on the set\n"},{"type":"element","tag":"a","props":{"href":"/configuration/command-linemd#global-options"},"children":[{"type":"text","value":"environment"}]},{"type":"text","value":"."}]},{"type":"element","tag":"table","props":{},"children":[{"type":"element","tag":"thead","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"Block name"}]},{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"Context"}]},{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"Label"}]},{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"Nested block(s)"}]}]}]},{"type":"element","tag":"tbody","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"environment"}]}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"Overall."}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"⚠ required, multiple labels are supported."}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"All configuration blocks of Couper."}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"environment"}]},{"type":"text","value":" block works like a preprocessor. If the label of an "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"environment"}]},{"type":"text","value":"\nblock do not match the set "},{"type":"element","tag":"a","props":{"href":"./CLI.md#global-options"},"children":[{"type":"text","value":"environment"}]},{"type":"text","value":" value, the preprocessor\nremoves this block and their content. Otherwise, the content of the block is applied\nto the configuration."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"If the "},{"type":"element","tag":"a","props":{"href":"/configuration/command-linemd#global-options"},"children":[{"type":"text","value":"environment"}]},{"type":"text","value":" value set to "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"prod"}]},{"type":"text","value":", the following configuration"}]},{"type":"element","tag":"code","props":{"code":"server {\n    api \"protected\" {\n        endpoint \"/secure\" {\n            environment \"prod\" {\n                access_control = [\"jwt\"]\n            }\n\n            proxy {\n                environment \"prod\" {\n                    url = \"https://protected-resource.org\"\n                }\n                environment \"stage\" {\n                    url = \"https://test-resource.org\"\n                }\n            }\n        }\n    }\n}\n","language":"hcl"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7f109b"},"children":[{"type":"text","value":"server"}]},{"type":"element","tag":"span","props":{"class":"ct-13bb8b"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-7f109b"},"children":[{"type":"text","value":"{"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-13bb8b"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-7f109b"},"children":[{"type":"text","value":"api"}]},{"type":"element","tag":"span","props":{"class":"ct-52fee6"},"children":[{"type":"text","value":" \"protected\""}]},{"type":"element","tag":"span","props":{"class":"ct-13bb8b"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-7f109b"},"children":[{"type":"text","value":"{"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-13bb8b"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-7f109b"},"children":[{"type":"text","value":"endpoint"}]},{"type":"element","tag":"span","props":{"class":"ct-52fee6"},"children":[{"type":"text","value":" \"/secure\""}]},{"type":"element","tag":"span","props":{"class":"ct-13bb8b"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-7f109b"},"children":[{"type":"text","value":"{"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-13bb8b"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-7f109b"},"children":[{"type":"text","value":"environment"}]},{"type":"element","tag":"span","props":{"class":"ct-52fee6"},"children":[{"type":"text","value":" \"prod\""}]},{"type":"element","tag":"span","props":{"class":"ct-13bb8b"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-7f109b"},"children":[{"type":"text","value":"{"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-13bb8b"},"children":[{"type":"text","value":"                "}]},{"type":"element","tag":"span","props":{"class":"ct-2a36f0"},"children":[{"type":"text","value":"access_control"}]},{"type":"element","tag":"span","props":{"class":"ct-13bb8b"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-087d61"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-13bb8b"},"children":[{"type":"text","value":" ["}]},{"type":"element","tag":"span","props":{"class":"ct-52fee6"},"children":[{"type":"text","value":"\"jwt\""}]},{"type":"element","tag":"span","props":{"class":"ct-13bb8b"},"children":[{"type":"text","value":"]"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-13bb8b"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-7f109b"},"children":[{"type":"text","value":"}"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-13bb8b"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-7f109b"},"children":[{"type":"text","value":"proxy"}]},{"type":"element","tag":"span","props":{"class":"ct-13bb8b"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-7f109b"},"children":[{"type":"text","value":"{"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-13bb8b"},"children":[{"type":"text","value":"                "}]},{"type":"element","tag":"span","props":{"class":"ct-7f109b"},"children":[{"type":"text","value":"environment"}]},{"type":"element","tag":"span","props":{"class":"ct-52fee6"},"children":[{"type":"text","value":" \"prod\""}]},{"type":"element","tag":"span","props":{"class":"ct-13bb8b"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-7f109b"},"children":[{"type":"text","value":"{"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-13bb8b"},"children":[{"type":"text","value":"                    "}]},{"type":"element","tag":"span","props":{"class":"ct-2a36f0"},"children":[{"type":"text","value":"url"}]},{"type":"element","tag":"span","props":{"class":"ct-13bb8b"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-087d61"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-13bb8b"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-52fee6"},"children":[{"type":"text","value":"\"https://protected-resource.org\""}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-13bb8b"},"children":[{"type":"text","value":"                "}]},{"type":"element","tag":"span","props":{"class":"ct-7f109b"},"children":[{"type":"text","value":"}"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-13bb8b"},"children":[{"type":"text","value":"                "}]},{"type":"element","tag":"span","props":{"class":"ct-7f109b"},"children":[{"type":"text","value":"environment"}]},{"type":"element","tag":"span","props":{"class":"ct-52fee6"},"children":[{"type":"text","value":" \"stage\""}]},{"type":"element","tag":"span","props":{"class":"ct-13bb8b"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-7f109b"},"children":[{"type":"text","value":"{"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-13bb8b"},"children":[{"type":"text","value":"                    "}]},{"type":"element","tag":"span","props":{"class":"ct-2a36f0"},"children":[{"type":"text","value":"url"}]},{"type":"element","tag":"span","props":{"class":"ct-13bb8b"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-087d61"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-13bb8b"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-52fee6"},"children":[{"type":"text","value":"\"https://test-resource.org\""}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-13bb8b"},"children":[{"type":"text","value":"                "}]},{"type":"element","tag":"span","props":{"class":"ct-7f109b"},"children":[{"type":"text","value":"}"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-13bb8b"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-7f109b"},"children":[{"type":"text","value":"}"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-13bb8b"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-7f109b"},"children":[{"type":"text","value":"}"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-13bb8b"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-7f109b"},"children":[{"type":"text","value":"}"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7f109b"},"children":[{"type":"text","value":"}"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"produces after the preprocessing the following configuration:"}]},{"type":"element","tag":"code","props":{"code":"server {\n    api \"protected\" {\n        endpoint \"/secure\" {\n            access_control = [\"jwt\"]\n\n            proxy {\n                url = \"https://protected-resource.org\"\n            }\n        }\n    }\n}\n","language":"hcl"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7f109b"},"children":[{"type":"text","value":"server"}]},{"type":"element","tag":"span","props":{"class":"ct-13bb8b"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-7f109b"},"children":[{"type":"text","value":"{"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-13bb8b"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-7f109b"},"children":[{"type":"text","value":"api"}]},{"type":"element","tag":"span","props":{"class":"ct-52fee6"},"children":[{"type":"text","value":" \"protected\""}]},{"type":"element","tag":"span","props":{"class":"ct-13bb8b"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-7f109b"},"children":[{"type":"text","value":"{"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-13bb8b"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-7f109b"},"children":[{"type":"text","value":"endpoint"}]},{"type":"element","tag":"span","props":{"class":"ct-52fee6"},"children":[{"type":"text","value":" \"/secure\""}]},{"type":"element","tag":"span","props":{"class":"ct-13bb8b"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-7f109b"},"children":[{"type":"text","value":"{"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-13bb8b"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-2a36f0"},"children":[{"type":"text","value":"access_control"}]},{"type":"element","tag":"span","props":{"class":"ct-13bb8b"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-087d61"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-13bb8b"},"children":[{"type":"text","value":" ["}]},{"type":"element","tag":"span","props":{"class":"ct-52fee6"},"children":[{"type":"text","value":"\"jwt\""}]},{"type":"element","tag":"span","props":{"class":"ct-13bb8b"},"children":[{"type":"text","value":"]"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-13bb8b"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-7f109b"},"children":[{"type":"text","value":"proxy"}]},{"type":"element","tag":"span","props":{"class":"ct-13bb8b"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-7f109b"},"children":[{"type":"text","value":"{"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-13bb8b"},"children":[{"type":"text","value":"                "}]},{"type":"element","tag":"span","props":{"class":"ct-2a36f0"},"children":[{"type":"text","value":"url"}]},{"type":"element","tag":"span","props":{"class":"ct-13bb8b"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-087d61"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-13bb8b"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-52fee6"},"children":[{"type":"text","value":"\"https://protected-resource.org\""}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-13bb8b"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-7f109b"},"children":[{"type":"text","value":"}"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-13bb8b"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-7f109b"},"children":[{"type":"text","value":"}"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-13bb8b"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-7f109b"},"children":[{"type":"text","value":"}"}]}]},{"type":"element","tag":"span","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-7f109b"},"children":[{"type":"text","value":"}"}]}]}]}]}]},{"type":"element","tag":"style","children":[{"type":"text","value":".ct-087d61{color:#D4D4D4}.ct-2a36f0{color:#9CDCFE}.ct-52fee6{color:#CE9178}.ct-13bb8b{color:#E6E6E6}.ct-7f109b{color:#569CD6}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[]}},"_type":"markdown","_id":"content:2.configuration:4.block:environment.md","_source":"content","_file":"2.configuration/4.block/environment.md","_extension":"md"}