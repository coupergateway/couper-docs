[{"_path":"/configuration/block/definitions","_draft":false,"_partial":false,"_locale":"en","_empty":false,"title":"Definitions","description":"Use the definitions block to define configurations you want to reuse.","excerpt":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"definitions"},"children":[{"type":"text","value":"Definitions"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Use the "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"definitions"}]},{"type":"text","value":" block to define configurations you want to reuse."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"⚠ "},{"type":"element","tag":"a","props":{"href":"../access-control"},"children":[{"type":"text","value":"access control"}]},{"type":"text","value":" is "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"always"}]},{"type":"text","value":" defined in the "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"definitions"}]},{"type":"text","value":" block."}]},{"type":"element","tag":"table","props":{},"children":[{"type":"element","tag":"thead","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"Block name"}]},{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"Context"}]},{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"Label"}]},{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"Nested block(s)"}]}]}]},{"type":"element","tag":"tbody","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"definitions"}]}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"no label"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"element","tag":"a","props":{"href":"backend"},"children":[{"type":"text","value":"Backend Block(s)"}]},{"type":"text","value":", "},{"type":"element","tag":"a","props":{"href":"basic_auth"},"children":[{"type":"text","value":"Basic Auth Block(s)"}]},{"type":"text","value":", "},{"type":"element","tag":"a","props":{"href":"jwt"},"children":[{"type":"text","value":"JWT Block(s)"}]},{"type":"text","value":", "},{"type":"element","tag":"a","props":{"href":"jwt_signing_profile"},"children":[{"type":"text","value":"JWT Signing Profile Block(s)"}]},{"type":"text","value":", "},{"type":"element","tag":"a","props":{"href":"saml"},"children":[{"type":"text","value":"SAML Block(s)"}]},{"type":"text","value":", "},{"type":"element","tag":"a","props":{"href":"oauth2"},"children":[{"type":"text","value":"OAuth2 AC Block(s)"}]},{"type":"text","value":", "},{"type":"element","tag":"a","props":{"href":"oidc"},"children":[{"type":"text","value":"OIDC Block(s)"}]},{"type":"text","value":", "},{"type":"element","tag":"a","props":{"href":"proxy"},"children":[{"type":"text","value":"Proxy Block(s)"}]}]}]}]}]}]},"_type":"markdown","_id":"content:2.configuration:4.block:definitions.md","_source":"content","_file":"2.configuration/4.block/definitions.md","_extension":"md"},{"_path":"/configuration/block/environment","_draft":false,"_partial":false,"_locale":"en","_empty":false,"title":"Environment","description":"The environment block lets you refine the Couper configuration based on the set\nenvironment.","excerpt":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"environment"},"children":[{"type":"text","value":"Environment"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"environment"}]},{"type":"text","value":" block lets you refine the Couper configuration based on the set\n"},{"type":"element","tag":"a","props":{"href":"../command-line#global-options"},"children":[{"type":"text","value":"environment"}]},{"type":"text","value":"."}]},{"type":"element","tag":"table","props":{},"children":[{"type":"element","tag":"thead","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"Block name"}]},{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"Context"}]},{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"Label"}]},{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"Nested block(s)"}]}]}]},{"type":"element","tag":"tbody","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"environment"}]}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"Overall."}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"⚠ required, multiple labels are supported."}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"All configuration blocks of Couper."}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"environment"}]},{"type":"text","value":" block works like a preprocessor. If the label of an "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"environment"}]},{"type":"text","value":"\nblock does not match the set "},{"type":"element","tag":"a","props":{"href":"../command-line#global-options"},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"COUPER_ENVIRONMENT"}]}]},{"type":"text","value":" value, the preprocessor\nremoves this block and its content. Otherwise, the content of the block is added\nto the configuration."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Starting Couper with a configuration containing "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"environment"}]},{"type":"text","value":" blocks will fail, if "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"COUPER_ENVIRONMENT"}]},{"type":"text","value":"\nis missing or empty. A default value can be set using the "},{"type":"element","tag":"a","props":{"href":"settings"},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"settings"}]},{"type":"text","value":" block"}]},{"type":"text","value":"."}]},{"type":"element","tag":"h2","props":{"id":"example"},"children":[{"type":"text","value":"Example"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Considering the following configuration with the "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"COUPER_ENVIRONMENT"}]},{"type":"text","value":" value set to "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"prod"}]}]},{"type":"element","tag":"code","props":{"code":"server {\n  api \"protected\" {\n    endpoint \"/secure\" {\n      environment \"prod\" {\n        access_control = [\"jwt\"]\n      }\n\n      proxy {\n        environment \"prod\" {\n          url = \"https://protected-resource.org\"\n        }\n        environment \"stage\" {\n          url = \"https://test-resource.org\"\n        }\n      }\n    }\n  }\n}\n","language":"hcl"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"server {\n  api \"protected\" {\n    endpoint \"/secure\" {\n      environment \"prod\" {\n        access_control = [\"jwt\"]\n      }\n\n      proxy {\n        environment \"prod\" {\n          url = \"https://protected-resource.org\"\n        }\n        environment \"stage\" {\n          url = \"https://test-resource.org\"\n        }\n      }\n    }\n  }\n}\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"the result will be:"}]},{"type":"element","tag":"code","props":{"code":"server {\n  api \"protected\" {\n    endpoint \"/secure\" {\n      access_control = [\"jwt\"]\n\n      proxy {\n        url = \"https://protected-resource.org\"\n      }\n    }\n  }\n}\n","language":"hcl"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"server {\n  api \"protected\" {\n    endpoint \"/secure\" {\n      access_control = [\"jwt\"]\n\n      proxy {\n        url = \"https://protected-resource.org\"\n      }\n    }\n  }\n}\n"}]}]}]}]},"_type":"markdown","_id":"content:2.configuration:4.block:environment.md","_source":"content","_file":"2.configuration/4.block/environment.md","_extension":"md"}]