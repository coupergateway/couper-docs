[{"data":1,"prerenderedAt":570},["Reactive",2],{"content-query-rEWRsFDOqJ":3},{"_path":4,"_dir":5,"_draft":6,"_partial":6,"_locale":7,"title":8,"description":9,"draft":6,"body":10,"_type":565,"_id":566,"_source":567,"_file":568,"_extension":569},"/configuration/block/backend","block",false,"","Backend","The backend defines the connection pool with given origin for outgoing connections.",{"type":11,"children":12,"toc":562},"root",[13,21,35,57,59,156,161,165,170,177,204,454,479,509,556],{"type":14,"tag":15,"props":16,"children":18},"element","h1",{"id":17},"backend",[19],{"type":20,"value":8},"text",{"type":14,"tag":22,"props":23,"children":24},"p",{},[25,27,33],{"type":20,"value":26},"The ",{"type":14,"tag":28,"props":29,"children":31},"code",{"className":30},[],[32],{"type":20,"value":17},{"type":20,"value":34}," block defines the connection to a local/remote backend service.",{"type":14,"tag":22,"props":36,"children":37},{},[38,40,47,49,55],{"type":20,"value":39},"Backends can be defined in the ",{"type":14,"tag":41,"props":42,"children":44},"a",{"href":43},"/configuration/block/definitions",[45],{"type":20,"value":46},"Definitions Block",{"type":20,"value":48}," and referenced by ",{"type":14,"tag":50,"props":51,"children":52},"em",{},[53],{"type":20,"value":54},"label",{"type":20,"value":56},".",{"type":20,"value":58},"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",{"type":14,"tag":60,"props":61,"children":62},"table",{},[63,88],{"type":14,"tag":64,"props":65,"children":66},"thead",{},[67],{"type":14,"tag":68,"props":69,"children":70},"tr",{},[71,78,83],{"type":14,"tag":72,"props":73,"children":75},"th",{"align":74},"left",[76],{"type":20,"value":77},"Block name",{"type":14,"tag":72,"props":79,"children":80},{"align":74},[81],{"type":20,"value":82},"Context",{"type":14,"tag":72,"props":84,"children":85},{"align":74},[86],{"type":20,"value":87},"Label",{"type":14,"tag":89,"props":90,"children":91},"tbody",{},[92],{"type":14,"tag":68,"props":93,"children":94},{},[95,104,147],{"type":14,"tag":96,"props":97,"children":98},"td",{"align":74},[99],{"type":14,"tag":28,"props":100,"children":102},{"className":101},[],[103],{"type":20,"value":17},{"type":14,"tag":96,"props":105,"children":106},{"align":74},[107,111,113,119,120,126,127,133,134,140,141],{"type":14,"tag":41,"props":108,"children":109},{"href":43},[110],{"type":20,"value":46},{"type":20,"value":112},", ",{"type":14,"tag":41,"props":114,"children":116},{"href":115},"/configuration/block/proxy",[117],{"type":20,"value":118},"Proxy Block",{"type":20,"value":112},{"type":14,"tag":41,"props":121,"children":123},{"href":122},"/configuration/block/request",[124],{"type":20,"value":125},"Request Block",{"type":20,"value":112},{"type":14,"tag":41,"props":128,"children":130},{"href":129},"/configuration/block/jwt",[131],{"type":20,"value":132},"JWT Block",{"type":20,"value":112},{"type":14,"tag":41,"props":135,"children":137},{"href":136},"/configuration/block/beta_oauth2",[138],{"type":20,"value":139},"OAuth2 AC (Beta) Block",{"type":20,"value":112},{"type":14,"tag":41,"props":142,"children":144},{"href":143},"/configuration/block/oidc",[145],{"type":20,"value":146},"OIDC Block",{"type":14,"tag":96,"props":148,"children":149},{"align":74},[150,152],{"type":20,"value":151},"âš  required, if defined in ",{"type":14,"tag":41,"props":153,"children":154},{"href":43},[155],{"type":20,"value":46},{"type":14,"tag":157,"props":158,"children":160},"attributes",{":values":159},"[{\"default\":\"\",\"description\":\"Key/value pairs to add form parameters to the upstream request body.\",\"name\":\"add_form_params\",\"type\":\"object\"},{\"default\":\"\",\"description\":\"Key/value pairs to add query parameters to the upstream request URL.\",\"name\":\"add_query_params\",\"type\":\"object\"},{\"default\":\"\",\"description\":\"Key/value pairs to add as request headers in the upstream request.\",\"name\":\"add_request_headers\",\"type\":\"object\"},{\"default\":\"\",\"description\":\"Key/value pairs to add as response headers in the client response.\",\"name\":\"add_response_headers\",\"type\":\"object\"},{\"default\":\"\",\"description\":\"Basic auth for the upstream request with format `user:pass`.\",\"name\":\"basic_auth\",\"type\":\"string\"},{\"default\":\"\\\"10s\\\"\",\"description\":\"The total timeout for dialing and connect to the origin.\",\"name\":\"connect_timeout\",\"type\":\"duration\"},{\"default\":\"\",\"description\":\"Log fields for [custom logging](/observation/logging#custom-logging). Inherited by nested blocks.\",\"name\":\"custom_log_fields\",\"type\":\"object\"},{\"default\":\"false\",\"description\":\"Disables the peer certificate validation. Must not be used in backend refinement.\",\"name\":\"disable_certificate_validation\",\"type\":\"bool\"},{\"default\":\"false\",\"description\":\"Disables reusage of connections to the origin. Must not be used in backend refinement.\",\"name\":\"disable_connection_reuse\",\"type\":\"bool\"},{\"default\":\"\",\"description\":\"Value of the HTTP host header field for the origin request. Since hostname replaces the request host the value will also be used for a server identity check during a TLS handshake with the origin.\",\"name\":\"hostname\",\"type\":\"string\"},{\"default\":\"false\",\"description\":\"Enables the HTTP2 support. Must not be used in backend refinement.\",\"name\":\"http2\",\"type\":\"bool\"},{\"default\":\"0\",\"description\":\"The maximum number of concurrent connections in any state (_active_ or _idle_) to the origin. Must not be used in backend refinement.\",\"name\":\"max_connections\",\"type\":\"number\"},{\"default\":\"\",\"description\":\"URL to connect to for backend requests.\",\"name\":\"origin\",\"type\":\"string\"},{\"default\":\"\",\"description\":\"Changeable part of upstream URL.\",\"name\":\"path\",\"type\":\"string\"},{\"default\":\"\",\"description\":\"Prefixes all backend request paths with the given prefix.\",\"name\":\"path_prefix\",\"type\":\"string\"},{\"default\":\"\",\"description\":\"A proxy URL for the related origin request.\",\"name\":\"proxy\",\"type\":\"string\"},{\"default\":\"\",\"description\":\"List of names to remove form parameters from the upstream request body.\",\"name\":\"remove_form_params\",\"type\":\"object\"},{\"default\":\"[]\",\"description\":\"List of names to remove query parameters from the upstream request URL.\",\"name\":\"remove_query_params\",\"type\":\"tuple (string)\"},{\"default\":\"[]\",\"description\":\"List of names to remove headers from the upstream request.\",\"name\":\"remove_request_headers\",\"type\":\"tuple (string)\"},{\"default\":\"[]\",\"description\":\"List of names to remove headers from the client response.\",\"name\":\"remove_response_headers\",\"type\":\"tuple (string)\"},{\"default\":\"\",\"description\":\"Key/value pairs to set query parameters in the upstream request URL.\",\"name\":\"set_form_params\",\"type\":\"object\"},{\"default\":\"\",\"description\":\"Key/value pairs to set query parameters in the upstream request URL.\",\"name\":\"set_query_params\",\"type\":\"object\"},{\"default\":\"\",\"description\":\"Key/value pairs to set as request headers in the upstream request.\",\"name\":\"set_request_headers\",\"type\":\"object\"},{\"default\":\"\",\"description\":\"Key/value pairs to set as response headers in the client response.\",\"name\":\"set_response_headers\",\"type\":\"object\"},{\"default\":\"\",\"description\":\"Modifies the response status code.\",\"name\":\"set_response_status\",\"type\":\"number\"},{\"default\":\"\\\"300s\\\"\",\"description\":\"The total deadline duration a backend request has for write and read/pipe.\",\"name\":\"timeout\",\"type\":\"duration\"},{\"default\":\"\\\"60s\\\"\",\"description\":\"The duration from writing the full request to the origin and receiving the answer.\",\"name\":\"ttfb_timeout\",\"type\":\"duration\"},{\"default\":\"false\",\"description\":\"Ignores the health state and continues with the outgoing request.\",\"name\":\"use_when_unhealthy\",\"type\":\"bool\"}]",[],{"type":14,"tag":162,"props":163,"children":164},"duration",{},[],{"type":14,"tag":166,"props":167,"children":169},"blocks",{":values":168},"[{\"description\":\"Configures a [health check](/configuration/block/health) (zero or one).\",\"name\":\"beta_health\"},{\"description\":\"Configures [rate limiting](/configuration/block/rate_limit) (zero or one).\",\"name\":\"beta_rate_limit\"},{\"description\":\"Configures a [token request authorization](/configuration/block/token_request) (zero or more).\",\"name\":\"beta_token_request\"},{\"description\":\"Configures an [OAuth2 authorization](/configuration/block/oauth2) (zero or one).\",\"name\":\"oauth2\"},{\"description\":\"Configures [OpenAPI validation](/configuration/block/openapi) (zero or one).\",\"name\":\"openapi\"},{\"description\":\"Configures [backend TLS](/configuration/block/backend_tls) (zero or one).\",\"name\":\"tls\"}]",[],{"type":14,"tag":171,"props":172,"children":174},"h2",{"id":173},"refining-a-referenced-backend",[175],{"type":20,"value":176},"Refining a referenced backend",{"type":14,"tag":22,"props":178,"children":179},{},[180,182,187,189,194,196,202],{"type":20,"value":181},"Referenced backends may be \"refined\" by using a labeled ",{"type":14,"tag":28,"props":183,"children":185},{"className":184},[],[186],{"type":20,"value":17},{"type":20,"value":188}," block in places where an unlabeled ",{"type":14,"tag":28,"props":190,"children":192},{"className":191},[],[193],{"type":20,"value":17},{"type":20,"value":195}," block would also be allowed, e.g. in a ",{"type":14,"tag":28,"props":197,"children":199},{"className":198},[],[200],{"type":20,"value":201},"proxy",{"type":20,"value":203}," block:",{"type":14,"tag":205,"props":206,"children":210},"pre",{"className":207,"code":208,"language":209,"meta":7,"style":7},"language-hcl shiki shiki-themes slack-dark","    proxy {\n      backend \"ref_be\" {      # refine referenced backend\n        path = \"/b\"           # override existing attribute value\n        add_form_params = {   # set new attribute\n          # ...\n        }\n      }\n    }\n\n# ...\n\ndefinitions {\n  backend \"ref_be\" {\n    origin = \"https://example.com\"\n    path = \"/a\"\n  }\n}\n","hcl",[211],{"type":14,"tag":28,"props":212,"children":213},{"__ignoreMap":7},[214,232,258,284,307,316,325,334,343,353,362,370,383,400,418,436,445],{"type":14,"tag":215,"props":216,"children":219},"span",{"class":217,"line":218},"line",1,[220,226],{"type":14,"tag":215,"props":221,"children":223},{"style":222},"--shiki-default:#4EC9B0",[224],{"type":20,"value":225},"    proxy",{"type":14,"tag":215,"props":227,"children":229},{"style":228},"--shiki-default:#E6E6E6",[230],{"type":20,"value":231}," {\n",{"type":14,"tag":215,"props":233,"children":235},{"class":217,"line":234},2,[236,241,247,252],{"type":14,"tag":215,"props":237,"children":238},{"style":222},[239],{"type":20,"value":240},"      backend",{"type":14,"tag":215,"props":242,"children":244},{"style":243},"--shiki-default:#9CDCFE",[245],{"type":20,"value":246}," \"ref_be\"",{"type":14,"tag":215,"props":248,"children":249},{"style":228},[250],{"type":20,"value":251}," {      ",{"type":14,"tag":215,"props":253,"children":255},{"style":254},"--shiki-default:#6A9955",[256],{"type":20,"value":257},"# refine referenced backend\n",{"type":14,"tag":215,"props":259,"children":261},{"class":217,"line":260},3,[262,267,273,279],{"type":14,"tag":215,"props":263,"children":264},{"style":243},[265],{"type":20,"value":266},"        path ",{"type":14,"tag":215,"props":268,"children":270},{"style":269},"--shiki-default:#D4D4D4",[271],{"type":20,"value":272},"=",{"type":14,"tag":215,"props":274,"children":276},{"style":275},"--shiki-default:#CE9178",[277],{"type":20,"value":278}," \"/b\"",{"type":14,"tag":215,"props":280,"children":281},{"style":254},[282],{"type":20,"value":283},"           # override existing attribute value\n",{"type":14,"tag":215,"props":285,"children":287},{"class":217,"line":286},4,[288,293,297,302],{"type":14,"tag":215,"props":289,"children":290},{"style":243},[291],{"type":20,"value":292},"        add_form_params ",{"type":14,"tag":215,"props":294,"children":295},{"style":269},[296],{"type":20,"value":272},{"type":14,"tag":215,"props":298,"children":299},{"style":228},[300],{"type":20,"value":301}," {   ",{"type":14,"tag":215,"props":303,"children":304},{"style":254},[305],{"type":20,"value":306},"# set new attribute\n",{"type":14,"tag":215,"props":308,"children":310},{"class":217,"line":309},5,[311],{"type":14,"tag":215,"props":312,"children":313},{"style":254},[314],{"type":20,"value":315},"          # ...\n",{"type":14,"tag":215,"props":317,"children":319},{"class":217,"line":318},6,[320],{"type":14,"tag":215,"props":321,"children":322},{"style":228},[323],{"type":20,"value":324},"        }\n",{"type":14,"tag":215,"props":326,"children":328},{"class":217,"line":327},7,[329],{"type":14,"tag":215,"props":330,"children":331},{"style":228},[332],{"type":20,"value":333},"      }\n",{"type":14,"tag":215,"props":335,"children":337},{"class":217,"line":336},8,[338],{"type":14,"tag":215,"props":339,"children":340},{"style":228},[341],{"type":20,"value":342},"    }\n",{"type":14,"tag":215,"props":344,"children":346},{"class":217,"line":345},9,[347],{"type":14,"tag":215,"props":348,"children":350},{"emptyLinePlaceholder":349},true,[351],{"type":20,"value":352},"\n",{"type":14,"tag":215,"props":354,"children":356},{"class":217,"line":355},10,[357],{"type":14,"tag":215,"props":358,"children":359},{"style":254},[360],{"type":20,"value":361},"# ...\n",{"type":14,"tag":215,"props":363,"children":365},{"class":217,"line":364},11,[366],{"type":14,"tag":215,"props":367,"children":368},{"emptyLinePlaceholder":349},[369],{"type":20,"value":352},{"type":14,"tag":215,"props":371,"children":373},{"class":217,"line":372},12,[374,379],{"type":14,"tag":215,"props":375,"children":376},{"style":222},[377],{"type":20,"value":378},"definitions",{"type":14,"tag":215,"props":380,"children":381},{"style":228},[382],{"type":20,"value":231},{"type":14,"tag":215,"props":384,"children":386},{"class":217,"line":385},13,[387,392,396],{"type":14,"tag":215,"props":388,"children":389},{"style":222},[390],{"type":20,"value":391},"  backend",{"type":14,"tag":215,"props":393,"children":394},{"style":243},[395],{"type":20,"value":246},{"type":14,"tag":215,"props":397,"children":398},{"style":228},[399],{"type":20,"value":231},{"type":14,"tag":215,"props":401,"children":403},{"class":217,"line":402},14,[404,409,413],{"type":14,"tag":215,"props":405,"children":406},{"style":243},[407],{"type":20,"value":408},"    origin ",{"type":14,"tag":215,"props":410,"children":411},{"style":269},[412],{"type":20,"value":272},{"type":14,"tag":215,"props":414,"children":415},{"style":275},[416],{"type":20,"value":417}," \"https://example.com\"\n",{"type":14,"tag":215,"props":419,"children":421},{"class":217,"line":420},15,[422,427,431],{"type":14,"tag":215,"props":423,"children":424},{"style":243},[425],{"type":20,"value":426},"    path ",{"type":14,"tag":215,"props":428,"children":429},{"style":269},[430],{"type":20,"value":272},{"type":14,"tag":215,"props":432,"children":433},{"style":275},[434],{"type":20,"value":435}," \"/a\"\n",{"type":14,"tag":215,"props":437,"children":439},{"class":217,"line":438},16,[440],{"type":14,"tag":215,"props":441,"children":442},{"style":228},[443],{"type":20,"value":444},"  }\n",{"type":14,"tag":215,"props":446,"children":448},{"class":217,"line":447},17,[449],{"type":14,"tag":215,"props":450,"children":451},{"style":228},[452],{"type":20,"value":453},"}\n",{"type":14,"tag":22,"props":455,"children":456},{},[457,459,464,466,471,473,477],{"type":20,"value":458},"If an attribute is set in both the ",{"type":14,"tag":50,"props":460,"children":461},{},[462],{"type":20,"value":463},"referenced",{"type":20,"value":465}," and the ",{"type":14,"tag":50,"props":467,"children":468},{},[469],{"type":20,"value":470},"refining",{"type":20,"value":472}," block, the value in the ",{"type":14,"tag":50,"props":474,"children":475},{},[476],{"type":20,"value":470},{"type":20,"value":478}," block is used.",{"type":14,"tag":22,"props":480,"children":481},{},[482,488,490,494,496,500,502,507],{"type":14,"tag":483,"props":484,"children":485},"strong",{},[486],{"type":20,"value":487},"Note:",{"type":20,"value":489}," Child ",{"type":14,"tag":50,"props":491,"children":492},{},[493],{"type":20,"value":166},{"type":20,"value":495}," and the following ",{"type":14,"tag":50,"props":497,"children":498},{},[499],{"type":20,"value":157},{"type":20,"value":501}," are not allowed in refining ",{"type":14,"tag":28,"props":503,"children":505},{"className":504},[],[506],{"type":20,"value":17},{"type":20,"value":508}," blocks:",{"type":14,"tag":510,"props":511,"children":512},"ul",{},[513,525,535,546],{"type":14,"tag":514,"props":515,"children":516},"li",{},[517,523],{"type":14,"tag":28,"props":518,"children":520},{"className":519},[],[521],{"type":20,"value":522},"disable_certificate_validation",{"type":20,"value":524},",",{"type":14,"tag":514,"props":526,"children":527},{},[528,534],{"type":14,"tag":28,"props":529,"children":531},{"className":530},[],[532],{"type":20,"value":533},"disable_connection_reuse",{"type":20,"value":524},{"type":14,"tag":514,"props":536,"children":537},{},[538,544],{"type":14,"tag":28,"props":539,"children":541},{"className":540},[],[542],{"type":20,"value":543},"http2",{"type":20,"value":545}," and",{"type":14,"tag":514,"props":547,"children":548},{},[549,555],{"type":14,"tag":28,"props":550,"children":552},{"className":551},[],[553],{"type":20,"value":554},"max_connections",{"type":20,"value":56},{"type":14,"tag":557,"props":558,"children":559},"style",{},[560],{"type":20,"value":561},"html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}",{"title":7,"searchDepth":234,"depth":234,"links":563},[564],{"id":173,"depth":234,"text":176},"markdown","content:2.configuration:4.block:backend.md","content","2.configuration/4.block/backend.md","md",1713208320490]